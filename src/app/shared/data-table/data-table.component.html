<mat-progress-bar
  *ngIf="(data.loading$ | async)"
  mode="query"
></mat-progress-bar>

<mat-spinner
  [class.hidden]="data.page$ | async"
  [diameter]="48"
  class="spinner"
></mat-spinner>

<table
  mat-table
  [dataSource]="data"
  [hidden]="!(data.page$ | async)"
>
  <ng-container
    *ngFor="let column of columns"
    matColumnDef="{{column}}"
  >
    <th mat-header-cell *matHeaderCellDef> {{headers[column] || column}} </th>
    <td
      mat-cell
      *matCellDef="let element"
      [ngStyle]="columnStyles[column]"
    >
      <ng-container
        *ngTemplateOutlet="render[column]; context: {element: element, column: column, value: element[column]}"></ng-container>
      <ng-container *ngIf="!render[column]">{{element[column]}}</ng-container>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columns"></tr>
  <tr mat-row *matRowDef="let row; columns: columns;"></tr>
</table>

<mat-progress-bar
  *ngIf="(data.loading$ | async)"
  mode="query"
></mat-progress-bar>

<ng-container *ngIf="false">
  <mat-paginator
    *ngIf="data.page$ | async as page"
    (page)="data.fetch($event)"
    [length]="page.totalCount"
    [pageSize]="page.size"
    [pageIndex]="page.index"
    [hidePageSize]="false"
    [pageSizeOptions]="[20, 50, 100, 300]"
  ></mat-paginator>
</ng-container>

