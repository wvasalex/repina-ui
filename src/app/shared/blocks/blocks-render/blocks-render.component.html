<div
  *ngFor="let block of $visible(blocks); let index = index; let first = first; let last = last;"
  [attr.rel]="typeKey + '_' + index"
  [attr.class]="typeKey + ' content-item'"
>
  <div
    *ngIf="editor && $hasControls(block)"
    class="move-block move-up controls"
  >
    <r-icon
      *ngIf="!first"
      (click)="$move(block, -1)"
      name="components/down-arrow"
      matTooltip="Переместить вверх"
      class="icon revert"
    ></r-icon>

    <r-icon
      (click)="$addBlock(block, 0)"
      name="components/add"
      matTooltip="Добавить блок выше"
      class="icon revert"
    ></r-icon>
  </div>

  <r-block-switcher
    *ngIf="editor && typeKey == 'element_type' && availableElements?.length"
    (change)="$setType(block, $event)"
    [availableElements]="availableElements"
  >
    {{block.element_type}}
  </r-block-switcher>

  <ndc-dynamic
    [ndcDynamicComponent]="$component(block)"
    [ndcDynamicInputs]="{
      id: block.id,
      props: block.props,
      contentFile: block.content_file,
      elements: block.content_elements,
      availableElements: availableElements,
      editor: editor,
      render: render
    }"
  ></ndc-dynamic>

  <!--<ng-container [ngSwitch]="block[typeKey]">
    <r-article-header
      *ngSwitchCase="'article-header'"
      [props]="block.props"
      [elements]="block.content_elements"
      [editor]="editor"
    ></r-article-header>

    <r-article-blank
      *ngSwitchCase="'article-blank'"
      [props]="block.props"
      [editor]="editor"
    ></r-article-blank>

    <r-article-part
      *ngSwitchCase="'article-part'"
      [props]="block.props"
      [elements]="block.content_elements"
      [availableElements]="availableElements"
      [editor]="editor"
    ></r-article-part>

    <r-article-text
      *ngSwitchCase="'article-text'"
      [props]="block.props"
      [editor]="editor"
    ></r-article-text>

    <r-article-image
      *ngSwitchCase="'article-image'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-article-image>

    <r-article-video
      *ngSwitchCase="'article-video'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-article-video>

    <r-article-quote
      *ngSwitchCase="'article-quote'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-article-quote>

    <r-article-author
      *ngSwitchCase="'article-author'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-article-author>

    <r-agency-primary
      *ngSwitchCase="'agency-primary'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-agency-primary>

    <r-agency-achievements
      *ngSwitchCase="'agency-achievements'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-agency-achievements>

    <r-agency-repina
      *ngSwitchCase="'agency-repina'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-agency-repina>

    <r-agency-team
      *ngSwitchCase="'agency-team'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-agency-team>

    <r-agency-awards
      *ngSwitchCase="'agency-awards'"
      [id]="block.id"
      [contentFile]="block.content_file"
      [props]="block.props"
      [editor]="editor"
    ></r-agency-awards>
  </ng-container>-->

  <div
    *ngIf="editor && $hasControls(block)"
    class="move-block move-down controls"
  >
    <r-icon
      *ngIf="!last"
      (click)="$move(block, 1)"
      name="components/down-arrow"
      matTooltip="Переместить вниз"
      class="icon"
    ></r-icon>

    <r-icon
      (click)="$addBlock(block, 1)"
      name="components/add"
      matTooltip="Добавить блок ниже"
      class="icon"
    ></r-icon>
  </div>

  <div
    *ngIf="editor && $hasControls(block)"
    class="main-controls row"
  >
    <mat-checkbox
      [(ngModel)]="block.is_enabled"
    ></mat-checkbox>

    <r-icon-button
      (click)="$swapElements(block)"
      [size]="18"
      icon="repeat"
      class="ml-2"
    ></r-icon-button>

    <r-icon-button
      (click)="$remove(block)"
      [size]="18"
      icon="close"
      class="ml-2"
    ></r-icon-button>
  </div>
</div>
